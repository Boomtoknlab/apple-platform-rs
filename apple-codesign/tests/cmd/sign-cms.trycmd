```
$ rcodesign debug-create-macho exe
assuming default minimum version 11.0.0
writing Mach-O to exe

$ rcodesign sign --pem-source src/testdata/self-signed-ed25519-apple-development.pem --signing-time 2023-11-05T10:00:00Z --timestamp-url none exe exe.apple-development
reading PEM data from src/testdata/self-signed-ed25519-apple-development.pem
registering signing key
automatically setting team ID from signing certificate: test
signing exe to exe.apple-development
signing exe as a Mach-O binary
inferring default signing settings from Mach-O binary
setting binary identifier to exe
parsing Mach-O
signing Mach-O binary at index 0
attempting to derive code requirements from signing certificate
code requirements: 0: (identifier "exe") and ((anchor apple generic) and ((certificate leaf[subject.CN] = "Apple Development: ED25519 Apple Development (test)") and (certificate 1[field.1.2.840.113635.100.6.2.1] /* exists */)));
binary targets macOS >= 11.0.0 with SDK 11.0.0
code directory version: 132096
creating cryptographic signature with certificate Apple Development: ED25519 Apple Development (test)
Using signing time 2023-11-05T10:00:00+00:00
total signature size: 1908 bytes
writing Mach-O to exe.apple-development

$ rcodesign extract cms-info exe.apple-development
signed content (embedded): None
signed content (external): Some("fade0c02000001410002040000000000000000a1000000580000000200000005000040102002000c")... (321 bytes)
signed content SHA-1:   7187d96250cef728030583ccd8ec0f7035cfebaf
signed content SHA-256: 69658fdd037a76a632b5a43d018c7a3960aa51d31a61cbca21cede8f24bb97dd
signed content SHA-384: 1a34d89e9c79f1bbff458f759c3b9962e2d89c0e0407cddea1222bcecd099a3f679616335d4f7c8aed7b59ea71489bd9
signed content SHA-512: acf126e4c49e001e352fa8aafb93f0a5331c7bedf97da65c37984ab65a3cf72b6dc0fd2bea0dcdd540fb9beb4840a1a81966e1726516552dad16b2a5ec93910e
certificate count: 1
certificate #0: subject CN=Apple Development: ED25519 Apple Development (test); self signed=true
signer count: 1
signer #0: digest algorithm: Sha256
signer #0: signature algorithm: Ed25519
signer #0: content type: 1.2.840.113549.1.7.1
signer #0: message digest: 69658fdd037a76a632b5a43d018c7a3960aa51d31a61cbca21cede8f24bb97dd
signer #0: signing time: Some(2023-11-05T10:00:00Z)
signer #0: signature content SHA-1:   21b99d196ce35ac1e3babf568e376a6a67fb0616
signer #0: signature content SHA-256: 689ba416bdafd29265be673e58fc2c166f94a039b5916cbf819697ad85c0abf5
signer #0: signature content SHA-384: f8728c88bbfb94d755fde2169de1f30c58fc054b8afc030a9fe705af594faa56462071e8307e153b89745564059c60cc
signer #0: signature content SHA-512: b2a655c783a862f653dffd622e438c14b9471ad46a99d72121ee4969a88ecdd68e463baa34a27f976136404f52ba247422270207fa6871899401d9659f215ecf
signer #0: signature valid: true
signer #0: time-stamp token present: false

$ rcodesign extract cms exe.apple-development
SignedData {
    digest_algorithms: {
        Sha256,
    },
    signed_content: None,
    certificates: Some(
        [
            CapturedX509Certificate {
                original: Ber(30820241308201f1a003020102020101300706032b6570050030819431143012060a0992268993f22c6401010c0474657374313c303a06035504030c334170706c6520446576656c6f706d656e743a2045443235353139204170706c6520446576656c6f706d656e7420287465737429310d300b060355040b0c047465737431223020060355040a0c1945443235353139204170706c6520446576656c6f706d656e74310b3009060355040613025553301e170d3233313130353033353731365a170d3233313130363033353731365a30819431143012060a0992268993f22c6401010c0474657374313c303a06035504030c334170706c6520446576656c6f706d656e743a2045443235353139204170706c6520446576656c6f706d656e7420287465737429310d300b060355040b0c047465737431223020060355040a0c1945443235353139204170706c6520446576656c6f706d656e74310b3009060355040613025553302c300706032b656e05000321007e5b24453d184254d63378b3aa6a644b3beb6f7b13b519bc3b69e19b4ad3a9aaa3623060300c0603551d130101ff0402300030160603551d250101ff040c300a06082b06010505070303300e0603551d0f0101ff0404030207803013060a2a864886f763640601020101ff040205003013060a2a864886f7636406010c0101ff04020500300706032b65700500034100e17978f3706b832ba471cf6c60f9076c49370db817eb24913ecb450c8de9e356901bc3045ce993cd69e458f438be1f72a363f1a99f210d137e7e3c134baed60e),
                inner: X509Certificate(
                    Certificate {
                        tbs_certificate: TbsCertificate {
                            version: Some(
                                V3,
                            ),
                            serial_number: Integer(
                                b"/x01",
                            ),
                            signature: AlgorithmIdentifier {
                                algorithm: 1.3.101.112,
                                parameters: Some(
                                    AlgorithmParameter(
                                        [ 05 00 ],
                                    ),
                                ),
                            },
                            issuer: RdnSequence(
                                RdnSequence(
                                    [
                                        RelativeDistinguishedName(
                                            [
                                                AttributeTypeAndValue {
                                                    type: 0.9.2342.19200300.100.1.1,
                                                    value: 0c0474657374,
                                                },
                                            ],
                                        ),
                                        RelativeDistinguishedName(
                                            [
                                                AttributeTypeAndValue {
                                                    type: 2.5.4.3,
                                                    value: 0c334170706c6520446576656c6f706d656e743a2045443235353139204170706c6520446576656c6f706d656e7420287465737429,
                                                },
                                            ],
                                        ),
                                        RelativeDistinguishedName(
                                            [
                                                AttributeTypeAndValue {
                                                    type: 2.5.4.11,
                                                    value: 0c0474657374,
                                                },
                                            ],
                                        ),
                                        RelativeDistinguishedName(
                                            [
                                                AttributeTypeAndValue {
                                                    type: 2.5.4.10,
                                                    value: 0c1945443235353139204170706c6520446576656c6f706d656e74,
                                                },
                                            ],
                                        ),
                                        RelativeDistinguishedName(
                                            [
                                                AttributeTypeAndValue {
                                                    type: 2.5.4.6,
                                                    value: 13025553,
                                                },
                                            ],
                                        ),
                                    ],
                                ),
                            ),
                            validity: Validity {
                                not_before: UtcTime(
                                    UtcTime(
                                        2023-11-05T03:57:16Z,
                                    ),
                                ),
                                not_after: UtcTime(
                                    UtcTime(
                                        2023-11-06T03:57:16Z,
                                    ),
                                ),
                            },
                            subject: RdnSequence(
                                RdnSequence(
                                    [
                                        RelativeDistinguishedName(
                                            [
                                                AttributeTypeAndValue {
                                                    type: 0.9.2342.19200300.100.1.1,
                                                    value: 0c0474657374,
                                                },
                                            ],
                                        ),
                                        RelativeDistinguishedName(
                                            [
                                                AttributeTypeAndValue {
                                                    type: 2.5.4.3,
                                                    value: 0c334170706c6520446576656c6f706d656e743a2045443235353139204170706c6520446576656c6f706d656e7420287465737429,
                                                },
                                            ],
                                        ),
                                        RelativeDistinguishedName(
                                            [
                                                AttributeTypeAndValue {
                                                    type: 2.5.4.11,
                                                    value: 0c0474657374,
                                                },
                                            ],
                                        ),
                                        RelativeDistinguishedName(
                                            [
                                                AttributeTypeAndValue {
                                                    type: 2.5.4.10,
                                                    value: 0c1945443235353139204170706c6520446576656c6f706d656e74,
                                                },
                                            ],
                                        ),
                                        RelativeDistinguishedName(
                                            [
                                                AttributeTypeAndValue {
                                                    type: 2.5.4.6,
                                                    value: 13025553,
                                                },
                                            ],
                                        ),
                                    ],
                                ),
                            ),
                            subject_public_key_info: SubjectPublicKeyInfo {
                                algorithm: AlgorithmIdentifier {
                                    algorithm: 1.3.101.110,
                                    parameters: Some(
                                        AlgorithmParameter(
                                            [ 05 00 ],
                                        ),
                                    ),
                                },
                                subject_public_key: 7e5b24453d184254d63378b3aa6a644b3beb6f7b13b519bc3b69e19b4ad3a9aa (unused 0),
                            },
                            issuer_unique_id: None,
                            subject_unique_id: None,
                            extensions: Some(
                                Extensions(
                                    [
                                        Extension {
                                            id: 2.5.29.19,
                                            critical: Some(
                                                true,
                                            ),
                                            value: 3000,
                                        },
                                        Extension {
                                            id: 2.5.29.37,
                                            critical: Some(
                                                true,
                                            ),
                                            value: 300a06082b06010505070303,
                                        },
                                        Extension {
                                            id: 2.5.29.15,
                                            critical: Some(
                                                true,
                                            ),
                                            value: 03020780,
                                        },
                                        Extension {
                                            id: 1.2.840.113635.100.6.1.2,
                                            critical: Some(
                                                true,
                                            ),
                                            value: 0500,
                                        },
                                        Extension {
                                            id: 1.2.840.113635.100.6.1.12,
                                            critical: Some(
                                                true,
                                            ),
                                            value: 0500,
                                        },
                                    ],
                                ),
                            ),
                            raw_data: Some("308201f1a003020102020101300706032b6570050030819431143012060a0992268993f22c6401010c0474657374313c303a06035504030c334170706c6520446576656c6f706d656e743a2045443235353139204170706c6520446576656c6f706d656e7420287465737429310d300b060355040b0c047465737431223020060355040a0c1945443235353139204170706c6520446576656c6f706d656e74310b3009060355040613025553301e170d3233313130353033353731365a170d3233313130363033353731365a30819431143012060a0992268993f22c6401010c0474657374313c303a06035504030c334170706c6520446576656c6f706d656e743a2045443235353139204170706c6520446576656c6f706d656e7420287465737429310d300b060355040b0c047465737431223020060355040a0c1945443235353139204170706c6520446576656c6f706d656e74310b3009060355040613025553302c300706032b656e05000321007e5b24453d184254d63378b3aa6a644b3beb6f7b13b519bc3b69e19b4ad3a9aaa3623060300c0603551d130101ff0402300030160603551d250101ff040c300a06082b06010505070303300e0603551d0f0101ff0404030207803013060a2a864886f763640601020101ff040205003013060a2a864886f7636406010c0101ff04020500"),
                        },
                        signature_algorithm: AlgorithmIdentifier {
                            algorithm: 1.3.101.112,
                            parameters: Some(
                                AlgorithmParameter(
                                    [ 05 00 ],
                                ),
                            ),
                        },
                        signature: e17978f3706b832ba471cf6c60f9076c49370db817eb24913ecb450c8de9e356901bc3045ce993cd69e458f438be1f72a363f1a99f210d137e7e3c134baed60e (unused 0),
                    },
                ),
            },
        ],
    ),
    signers: [
        SignerInfo {
            issuer: RdnSequence(
                RdnSequence(
                    [
                        RelativeDistinguishedName(
                            [
                                AttributeTypeAndValue {
                                    type: 0.9.2342.19200300.100.1.1,
                                    value: 0c0474657374,
                                },
                            ],
                        ),
                        RelativeDistinguishedName(
                            [
                                AttributeTypeAndValue {
                                    type: 2.5.4.3,
                                    value: 0c334170706c6520446576656c6f706d656e743a2045443235353139204170706c6520446576656c6f706d656e7420287465737429,
                                },
                            ],
                        ),
                        RelativeDistinguishedName(
                            [
                                AttributeTypeAndValue {
                                    type: 2.5.4.11,
                                    value: 0c0474657374,
                                },
                            ],
                        ),
                        RelativeDistinguishedName(
                            [
                                AttributeTypeAndValue {
                                    type: 2.5.4.10,
                                    value: 0c1945443235353139204170706c6520446576656c6f706d656e74,
                                },
                            ],
                        ),
                        RelativeDistinguishedName(
                            [
                                AttributeTypeAndValue {
                                    type: 2.5.4.6,
                                    value: 13025553,
                                },
                            ],
                        ),
                    ],
                ),
            ),
            serial_number: Integer(
                b"/x01",
            ),
            digest_algorithm: Sha256,
            signature_algorithm: Ed25519,
            signature: e46f8e4ef768038236f192af5392e53114d9584951b77128a8083911fe425a484885a900e747661981a861402c374f67b34d0153ed9ea9982de31ab53634ff06,
            signed_attributes: Some(
                SignedAttributes {
                    content_type: 1.2.840.113549.1.7.1,
                    message_digest: 69658fdd037a76a632b5a43d018c7a3960aa51d31a61cbca21cede8f24bb97dd,
                    signing_time: Some(
                        2023-11-05T10:00:00Z,
                    ),
                },
            ),
            digested_signed_attributes_data: Some("318201d4301806092a864886f70d010903310b06092a864886f70d010701301c06092a864886f70d010905310f170d3233313130353130303030305a302f06092a864886f70d0109043122042069658fdd037a76a632b5a43d018c7a3960aa51d31a61cbca21cede8f24bb97dd303c06092a864886f763640902312f302d0609608648016503040201042069658fdd037a76a632b5a43d018c7a3960aa51d31a61cbca21cede8f24bb97dd3082012906092a864886f7636409013182011a048201163c3f786d6c2076657273696f6e3d22312e302220656e636f64696e673d225554462d38223f3e0a3c21444f435459504520706c697374205055424c494320222d2f2f4170706c652f2f44544420504c49535420312e302f2f454e222022687474703a2f2f7777772e6170706c652e636f6d2f445444732f50726f70657274794c6973742d312e302e647464223e0a3c706c6973742076657273696f6e3d22312e30223e0a3c646963743e0a093c6b65793e63646861736865733c2f6b65793e0a093c61727261793e0a09093c646174613e0a09096157575033514e366471597974615139415978364f57437155644d3d0a09093c2f646174613e0a093c2f61727261793e0a3c2f646963743e0a3c2f706c6973743e0a"),
            unsigned_attributes: None,
        },
    ],
}

$ rcodesign print-signature-info exe.apple-development
- path: exe.apple-development
  file_size: 22544
  file_sha256: f2e98ec570900b95120ebafca6e03723c312578dc367c0e26a153b88d5775da6
  entity:
    mach_o:
      linkedit_segment_file_start_offset: 16384
      linkedit_segment_file_end_offset: 22544
      signature_file_start_offset: 16400
      signature_file_end_offset: 22544
      signature_linkedit_start_offset: 16
      signature_linkedit_end_offset: 6160
      signature:
        superblob_length: 1908
        blob_count: 3
        blobs:
        - slot: CodeDirectory (0)
          magic: fade0c02
          length: 321
          sha1: 7187d96250cef728030583ccd8ec0f7035cfebaf
          sha256: 69658fdd037a76a632b5a43d018c7a3960aa51d31a61cbca21cede8f24bb97dd
        - slot: RequirementSet (2)
          magic: fade0c01
          length: 172
          sha1: 7ef40467d549ac623235b0e2f2ec9dfd67cf0217
          sha256: b5d1cc0c9cce08739d37a1aa101f958532d5c61bb6056de826cba88481e1d39a
        - slot: CMS Signature (65536)
          magic: fade0b01
          length: 1379
          sha1: 142e0069821957d20062ea1f29feb7b256697351
          sha256: 8691ff1601cae61e139cc1548a4343772d8c6a0aa2d1399b84c495ba204672bd
        code_directory:
          version: '0x20400'
          flags: CodeSignatureFlags(0x0)
          identifier: exe
          team_name: test
          digest_type: sha256
          platform: 0
          signed_entity_size: 16400
          executable_segment_flags: ExecutableSegmentFlags(MAIN_BINARY)
          code_digests_count: 5
          slot_digests:
          - 'Info (1): 0000000000000000000000000000000000000000000000000000000000000000'
          - 'RequirementSet (2): b5d1cc0c9cce08739d37a1aa101f958532d5c61bb6056de826cba88481e1d39a'
        code_requirements:
        - 'designated(3): 0: (identifier "exe") and ((anchor apple generic) and ((certificate leaf[subject.CN] = "Apple Development: ED25519 Apple Development (test)") and (certificate 1[field.1.2.840.113635.100.6.2.1] /* exists */)));'
        cms:
          certificates:
          - subject: 'CN=Apple Development: ED25519 Apple Development (test), OU=test, O=ED25519 Apple Development, C=US'
            issuer: 'CN=Apple Development: ED25519 Apple Development (test), OU=test, O=ED25519 Apple Development, C=US'
            key_algorithm: ED25519
            signature_algorithm: ED25519
            signed_with_algorithm: ED25519
            is_apple_root_ca: false
            is_apple_intermediate_ca: false
            chains_to_apple_root_ca: false
            apple_extended_key_usages:
            - Code Signing
            apple_code_signing_extensions:
            - iPhone Developer
            - Mac Developer
            apple_certificate_profile: apple-development
            apple_team_id: test
          signers:
          - issuer: 'CN=Apple Development: ED25519 Apple Development (test), OU=test, O=ED25519 Apple Development, C=US'
            digest_algorithm: SHA-256
            signature_algorithm: ED25519
            attributes:
            - 1.2.840.113549.1.9.3
            - 1.2.840.113549.1.9.4
            - 1.2.840.113549.1.9.5
            - 1.2.840.113635.100.9.1
            - 1.2.840.113635.100.9.2
            content_type: 1.2.840.113549.1.7.1
            message_digest: 69658fdd037a76a632b5a43d018c7a3960aa51d31a61cbca21cede8f24bb97dd
            signing_time: 2023-11-05T10:00:00Z
            cdhash_plist:
            - <?xml version="1.0" encoding="UTF-8"?>
            - <plist version="1.0">
            - '  <dict>'
            - '    <key>cdhashes</key>'
            - '    <array>'
            - '      <data>'
            - "/t/taWWP3QN6dqYytaQ9AYx6OWCqUdM="
            - "/t/t</data>"
            - '    </array>'
            - '  </dict>'
            - </plist>
            cdhash_digests:
            - - 2.16.840.1.101.3.4.2.1
              - 69658fdd037a76a632b5a43d018c7a3960aa51d31a61cbca21cede8f24bb97dd
            signature_verifies: true

$ rcodesign sign --pem-source src/testdata/self-signed-ed25519-apple-distribution.pem --signing-time 2023-11-05T10:00:00Z --timestamp-url none exe exe.apple-distribution
reading PEM data from src/testdata/self-signed-ed25519-apple-distribution.pem
registering signing key
automatically setting team ID from signing certificate: test
signing exe to exe.apple-distribution
signing exe as a Mach-O binary
inferring default signing settings from Mach-O binary
setting binary identifier to exe
parsing Mach-O
signing Mach-O binary at index 0
attempting to derive code requirements from signing certificate
code requirements: 0: (identifier "exe") and ((anchor apple generic) and ((certificate leaf[subject.CN] = "Apple Distribution: ED25519 Apple Distribution (test)") and (certificate 1[field.1.2.840.113635.100.6.2.1] /* exists */)));
binary targets macOS >= 11.0.0 with SDK 11.0.0
code directory version: 132096
creating cryptographic signature with certificate Apple Distribution: ED25519 Apple Distribution (test)
Using signing time 2023-11-05T10:00:00+00:00
total signature size: 1921 bytes
writing Mach-O to exe.apple-distribution

$ rcodesign print-signature-info exe.apple-distribution
- path: exe.apple-distribution
  file_size: 22544
  file_sha256: 02e1d272436d186d92794b06d4eee4a7ce534df9e62ce2e1ea1c79212d3da0ff
  entity:
    mach_o:
      linkedit_segment_file_start_offset: 16384
      linkedit_segment_file_end_offset: 22544
      signature_file_start_offset: 16400
      signature_file_end_offset: 22544
      signature_linkedit_start_offset: 16
      signature_linkedit_end_offset: 6160
      signature:
        superblob_length: 1921
        blob_count: 3
        blobs:
        - slot: CodeDirectory (0)
          magic: fade0c02
          length: 321
          sha1: a9ca92a7fe8679eb691ecca7374a71fc3d04d4d9
          sha256: 291d36c43614c8fdedf3be13bb779c382c6c159f9021f4feb04a4f4afe0dec03
        - slot: RequirementSet (2)
          magic: fade0c01
          length: 176
          sha1: 37e48825f4f9ae47e4df40979edf73149969e0f1
          sha256: ed8270544b74edb19a6324c05e70c8fa2890cdce76a749b3af48f6b9e39fd09f
        - slot: CMS Signature (65536)
          magic: fade0b01
          length: 1388
          sha1: 6b7848b9b51a99085ff716ee49dccabcae35aa72
          sha256: b7579c0d21e563b24425d3cee8cf9f067819ef15ff6a48204a411be1c36fc05b
        code_directory:
          version: '0x20400'
          flags: CodeSignatureFlags(0x0)
          identifier: exe
          team_name: test
          digest_type: sha256
          platform: 0
          signed_entity_size: 16400
          executable_segment_flags: ExecutableSegmentFlags(MAIN_BINARY)
          code_digests_count: 5
          slot_digests:
          - 'Info (1): 0000000000000000000000000000000000000000000000000000000000000000'
          - 'RequirementSet (2): ed8270544b74edb19a6324c05e70c8fa2890cdce76a749b3af48f6b9e39fd09f'
        code_requirements:
        - 'designated(3): 0: (identifier "exe") and ((anchor apple generic) and ((certificate leaf[subject.CN] = "Apple Distribution: ED25519 Apple Distribution (test)") and (certificate 1[field.1.2.840.113635.100.6.2.1] /* exists */)));'
        cms:
          certificates:
          - subject: 'CN=Apple Distribution: ED25519 Apple Distribution (test), OU=test, O=ED25519 Apple Distribution, C=US'
            issuer: 'CN=Apple Distribution: ED25519 Apple Distribution (test), OU=test, O=ED25519 Apple Distribution, C=US'
            key_algorithm: ED25519
            signature_algorithm: ED25519
            signed_with_algorithm: ED25519
            is_apple_root_ca: false
            is_apple_intermediate_ca: false
            chains_to_apple_root_ca: false
            apple_extended_key_usages:
            - Code Signing
            apple_code_signing_extensions:
            - Apple Mac App Signing (Development)
            - Apple Developer Certificate (Submission)
            apple_certificate_profile: apple-distribution
            apple_team_id: test
          signers:
          - issuer: 'CN=Apple Distribution: ED25519 Apple Distribution (test), OU=test, O=ED25519 Apple Distribution, C=US'
            digest_algorithm: SHA-256
            signature_algorithm: ED25519
            attributes:
            - 1.2.840.113549.1.9.3
            - 1.2.840.113549.1.9.4
            - 1.2.840.113549.1.9.5
            - 1.2.840.113635.100.9.1
            - 1.2.840.113635.100.9.2
            content_type: 1.2.840.113549.1.7.1
            message_digest: 291d36c43614c8fdedf3be13bb779c382c6c159f9021f4feb04a4f4afe0dec03
            signing_time: 2023-11-05T10:00:00Z
            cdhash_plist:
            - <?xml version="1.0" encoding="UTF-8"?>
            - <plist version="1.0">
            - '  <dict>'
            - '    <key>cdhashes</key>'
            - '    <array>'
            - '      <data>'
            - "/t/tKR02xDYUyP3t874Tu3ecOCxsFZ8="
            - "/t/t</data>"
            - '    </array>'
            - '  </dict>'
            - </plist>
            cdhash_digests:
            - - 2.16.840.1.101.3.4.2.1
              - 291d36c43614c8fdedf3be13bb779c382c6c159f9021f4feb04a4f4afe0dec03
            signature_verifies: true

$ rcodesign sign --pem-source src/testdata/self-signed-ed25519-developer-id-application.pem --signing-time 2023-11-05T10:00:00Z --timestamp-url none exe exe.developer-id-application
reading PEM data from src/testdata/self-signed-ed25519-developer-id-application.pem
registering signing key
automatically setting team ID from signing certificate: test
signing exe to exe.developer-id-application
signing exe as a Mach-O binary
inferring default signing settings from Mach-O binary
setting binary identifier to exe
parsing Mach-O
signing Mach-O binary at index 0
attempting to derive code requirements from signing certificate
code requirements: 0: (identifier "exe") and ((anchor apple generic) and ((certificate 1[field.1.2.840.113635.100.6.2.6] /* exists */) and ((certificate leaf[field.1.2.840.113635.100.6.1.13] /* exists */) and (certificate leaf[subject.OU] = "test"))));
binary targets macOS >= 11.0.0 with SDK 11.0.0
code directory version: 132096
creating cryptographic signature with certificate Developer ID Application: ED25519 Developer ID Application (test)
Using signing time 2023-11-05T10:00:00+00:00
total signature size: 1934 bytes
writing Mach-O to exe.developer-id-application

$ rcodesign print-signature-info exe.developer-id-application
- path: exe.developer-id-application
  file_size: 22544
  file_sha256: e4fe610b26015436aa49e7c712c8f26f1f9a49bfaf0d583edaca7291eaa47344
  entity:
    mach_o:
      linkedit_segment_file_start_offset: 16384
      linkedit_segment_file_end_offset: 22544
      signature_file_start_offset: 16400
      signature_file_end_offset: 22544
      signature_linkedit_start_offset: 16
      signature_linkedit_end_offset: 6160
      signature:
        superblob_length: 1934
        blob_count: 3
        blobs:
        - slot: CodeDirectory (0)
          magic: fade0c02
          length: 321
          sha1: 531d2b126d6583989091af2698f0ab638192593e
          sha256: 58f1b1687651ee57c743e3a1ebb9f40d3febe0f3338a4a47d2e91298feb040f8
        - slot: RequirementSet (2)
          magic: fade0c01
          length: 156
          sha1: 151f6b774522f253d6b85dfd8d390b8c13b0b1e5
          sha256: af09fdfc77f0ab68572b850dc5cf9da0571072b5fb5d9a9c23268b5f4bec2502
        - slot: CMS Signature (65536)
          magic: fade0b01
          length: 1421
          sha1: 908ffe372fc10d1aad579be54457789eb1ff3a1b
          sha256: b9c67cbb5c5d3b89bf61e451617ebc2ddd1b114aada9cb99b2beec83b3748794
        code_directory:
          version: '0x20400'
          flags: CodeSignatureFlags(0x0)
          identifier: exe
          team_name: test
          digest_type: sha256
          platform: 0
          signed_entity_size: 16400
          executable_segment_flags: ExecutableSegmentFlags(MAIN_BINARY)
          code_digests_count: 5
          slot_digests:
          - 'Info (1): 0000000000000000000000000000000000000000000000000000000000000000'
          - 'RequirementSet (2): af09fdfc77f0ab68572b850dc5cf9da0571072b5fb5d9a9c23268b5f4bec2502'
        code_requirements:
        - 'designated(3): 0: (identifier "exe") and ((anchor apple generic) and ((certificate 1[field.1.2.840.113635.100.6.2.6] /* exists */) and ((certificate leaf[field.1.2.840.113635.100.6.1.13] /* exists */) and (certificate leaf[subject.OU] = "test"))));'
        cms:
          certificates:
          - subject: 'CN=Developer ID Application: ED25519 Developer ID Application (test), OU=test, O=ED25519 Developer ID Application, C=US'
            issuer: 'CN=Developer ID Application: ED25519 Developer ID Application (test), OU=test, O=ED25519 Developer ID Application, C=US'
            key_algorithm: ED25519
            signature_algorithm: ED25519
            signed_with_algorithm: ED25519
            is_apple_root_ca: false
            is_apple_intermediate_ca: false
            chains_to_apple_root_ca: false
            apple_extended_key_usages:
            - Code Signing
            apple_code_signing_extensions:
            - Developer ID Application
            apple_certificate_profile: developer-id-application
            apple_team_id: test
          signers:
          - issuer: 'CN=Developer ID Application: ED25519 Developer ID Application (test), OU=test, O=ED25519 Developer ID Application, C=US'
            digest_algorithm: SHA-256
            signature_algorithm: ED25519
            attributes:
            - 1.2.840.113549.1.9.3
            - 1.2.840.113549.1.9.4
            - 1.2.840.113549.1.9.5
            - 1.2.840.113635.100.9.1
            - 1.2.840.113635.100.9.2
            content_type: 1.2.840.113549.1.7.1
            message_digest: 58f1b1687651ee57c743e3a1ebb9f40d3febe0f3338a4a47d2e91298feb040f8
            signing_time: 2023-11-05T10:00:00Z
            cdhash_plist:
            - <?xml version="1.0" encoding="UTF-8"?>
            - <plist version="1.0">
            - '  <dict>'
            - '    <key>cdhashes</key>'
            - '    <array>'
            - '      <data>'
            - "/t/tWPGxaHZR7lfHQ+Oh67n0DT/r4PM="
            - "/t/t</data>"
            - '    </array>'
            - '  </dict>'
            - </plist>
            cdhash_digests:
            - - 2.16.840.1.101.3.4.2.1
              - 58f1b1687651ee57c743e3a1ebb9f40d3febe0f3338a4a47d2e91298feb040f8
            signature_verifies: true

$ rcodesign sign --pem-source src/testdata/self-signed-ed25519-developer-id-installer.pem --signing-time 2023-11-05T10:00:00Z --timestamp-url none exe exe.developer-id-installer
? 1
reading PEM data from src/testdata/self-signed-ed25519-developer-id-installer.pem
registering signing key
automatically setting team ID from signing certificate: test
signing exe to exe.developer-id-installer
signing exe as a Mach-O binary
inferring default signing settings from Mach-O binary
setting binary identifier to exe
parsing Mach-O
signing Mach-O binary at index 0
attempting to derive code requirements from signing certificate
Error: unable to generate code requirement policy: (deriving for DeveloperIdInstaller) a designated requirement cannot be derived for installer code signing certificates; if you see this message you should probably be using a different code signing certificate for signing applications

$ rcodesign print-signature-info exe.developer-id-installer
? 1
Error: specified path is not of a recognized type

$ rcodesign sign --pem-source src/testdata/self-signed-ed25519-mac-installer-distribution.pem --signing-time 2023-11-05T10:00:00Z --timestamp-url none exe exe.mac-installer-distribution
? 1
reading PEM data from src/testdata/self-signed-ed25519-mac-installer-distribution.pem
registering signing key
automatically setting team ID from signing certificate: test
signing exe to exe.mac-installer-distribution
signing exe as a Mach-O binary
inferring default signing settings from Mach-O binary
setting binary identifier to exe
parsing Mach-O
signing Mach-O binary at index 0
attempting to derive code requirements from signing certificate
Error: unable to generate code requirement policy: (deriving for MacInstallerDistribution) a designated requirement cannot be derived for installer code signing certificates; if you see this message you should probably be using a different code signing certificate for signing applications

$ rcodesign print-signature-info exe.mac-installer-distribution
? 1
Error: specified path is not of a recognized type

```
