Signing with a PKCS#12 / PFX file works

```
$ rcodesign debug-create-macho exe
assuming default minimum version 11.0.0
writing Mach-O to exe

$ rcodesign sign --p12-file src/testdata/self-signed-rsa-apple-development.p12 --p12-password password --signing-time 2023-11-05T10:00:00Z --timestamp-url none exe exe.signed
registering signing key
automatically setting team ID from signing certificate: test
signing exe to exe.signed
signing exe as a Mach-O binary
setting binary identifier to exe
parsing Mach-O
creating cryptographic signature with certificate Apple Development: RSA Apple Development (test)
writing Mach-O to exe.signed

$ rcodesign extract cms-info exe.signed
signed content (embedded): None
signed content (external): Some("fade0c02000001410002040000000000000000a1000000580000000200000005000040102002000c")... (321 bytes)
signed content SHA-1:   27ee9bba25ab1744a2127907053d482591fd6efe
signed content SHA-256: 842501a2635a78877a86ef6545d12b4270bdf05f1a28b196a72686348e37a066
signed content SHA-384: 13da29451ce26c63c5b7cb4ff4c2398fe812ca98a1798bee6ed55d3f6b5bad39959b403d5f0060960d17bba6462d7675
signed content SHA-512: bc0128772e654fb50c4b959ec0a6ecf86c0f6c0121287c9b6438c256e753d0bf7677f2418a5126b347866da9b21c4adb470f5f98c5e15b2ae135fe82bf9d0d5a
certificate count: 1
certificate #0: subject CN=Apple Development: RSA Apple Development (test); self signed=true
signer count: 1
signer #0: digest algorithm: Sha256
signer #0: signature algorithm: RsaSha256
signer #0: content type: 1.2.840.113549.1.7.1
signer #0: message digest: 842501a2635a78877a86ef6545d12b4270bdf05f1a28b196a72686348e37a066
signer #0: signing time: Some(2023-11-05T10:00:00Z)
signer #0: signature content SHA-1:   978d9484e038d086d52c475d117264b034079776
signer #0: signature content SHA-256: 07a86c368e022c298674b8e58975baecb28922d2eae70f9a2c87ef6528c10e12
signer #0: signature content SHA-384: 04815d1c0b51f48212a56b814d87c010dedd6246f5de144c28790bd1e7b5fc9d77cfde4e02f45e593a04c4fc8ddbf595
signer #0: signature content SHA-512: 01a4b80be474295945f5973c746426a486990ed2a6956d09aa94815fcbdeea278215fb4393c23e5fc8fb24d2e91a319e87c03d993c84a6712e3dbc577fccef91
signer #0: signature valid: true
signer #0: time-stamp token present: false

$ rcodesign extract cms exe.signed
SignedData {
    digest_algorithms: {
        Sha256,
    },
    signed_content: None,
    certificates: Some(
        [
            CapturedX509Certificate {
                original: Ber(308203f7308202dfa003020102020101300d06092a864886f70d01010b050030818c31143012060a0992268993f22c6401010c04746573743138303606035504030c2f4170706c6520446576656c6f706d656e743a20525341204170706c6520446576656c6f706d656e7420287465737429310d300b060355040b0c0474657374311e301c060355040a0c15525341204170706c6520446576656c6f706d656e74310b3009060355040613025553301e170d3233313130373130343932385a170d3337303731363130343932385a30818c31143012060a0992268993f22c6401010c04746573743138303606035504030c2f4170706c6520446576656c6f706d656e743a20525341204170706c6520446576656c6f706d656e7420287465737429310d300b060355040b0c0474657374311e301c060355040a0c15525341204170706c6520446576656c6f706d656e74310b300906035504061302555330820122300d06092a864886f70d01010105000382010f003082010a0282010100e6c9e2a15c321fbad0442e10bebb9824c6319fdaa7afd7c227bda4a81e152b9728855a375e34249f85f4127207a658bc091b447bb499f1f0884eecc98187630200f24c4d08e557624c33a4021ab5528581a92b902b4d436c3033cc27f67242f3eff171ed62f316fc0f138eb927e8d0568aecf11fc519487608509037e1382d81998c12f7b5913dd14bf9c26880bcc270c46b872023f83bdd1ba2395b34d6873ca5ff703dffbce5f561b55361a5a3bd01bfeda19f20b1a6bc89aadffb643d3e8faf2329609e11a587732f85405102de6a2cd76c2f95c95e22dd7af7ae9b8f238d2c60abad0595b3fa9c96b52e9ab95ef7af4596112de6fa5862aebc7aa24fe1fb0203010001a3623060300c0603551d130101ff0402300030160603551d250101ff040c300a06082b06010505070303300e0603551d0f0101ff0404030207803013060a2a864886f763640601020101ff040205003013060a2a864886f7636406010c0101ff04020500300d06092a864886f70d01010b0500038201010099563303c646c61728b9758f16c559e6e1be2eae0884c8535834062b81f21c89a94c89c0ffb25b93b886535749d81e94440f6d257438e07cc701a7e69aa8bdeca71c3d2f686357f842c62a27b045c671b487d89fd3e69458aae19d69274e7b2d54f7f736e25196738185cab05ccd71b4d8a180610e1f771cfeee0198047692ec87fd3a4dbac1db4ff8205ddd7445d6184b11e3ca7018d6a495fa4b44bc1325fdd68050b45dddadf3a9a9ea0575a5b6d7a9d636f052f3b3d79729bf475efc9c95db4154f14d2ae598cb0debd424e0f0bfe59f11668f1e80e52412ae3f722bab026439addcf9a07b81cd17dec724afa51128e092038203c137f602cb154397c05a),
                inner: X509Certificate(
                    Certificate {
                        tbs_certificate: TbsCertificate {
                            version: Some(
                                V3,
                            ),
                            serial_number: Integer(
                                b"/x01",
                            ),
                            signature: AlgorithmIdentifier {
                                algorithm: 1.2.840.113549.1.1.11,
                                parameters: Some(
                                    AlgorithmParameter(
                                        [ 05 00 ],
                                    ),
                                ),
                            },
                            issuer: RdnSequence(
                                RdnSequence(
                                    [
                                        RelativeDistinguishedName(
                                            [
                                                AttributeTypeAndValue {
                                                    type: 0.9.2342.19200300.100.1.1,
                                                    value: 0c0474657374,
                                                },
                                            ],
                                        ),
                                        RelativeDistinguishedName(
                                            [
                                                AttributeTypeAndValue {
                                                    type: 2.5.4.3,
                                                    value: 0c2f4170706c6520446576656c6f706d656e743a20525341204170706c6520446576656c6f706d656e7420287465737429,
                                                },
                                            ],
                                        ),
                                        RelativeDistinguishedName(
                                            [
                                                AttributeTypeAndValue {
                                                    type: 2.5.4.11,
                                                    value: 0c0474657374,
                                                },
                                            ],
                                        ),
                                        RelativeDistinguishedName(
                                            [
                                                AttributeTypeAndValue {
                                                    type: 2.5.4.10,
                                                    value: 0c15525341204170706c6520446576656c6f706d656e74,
                                                },
                                            ],
                                        ),
                                        RelativeDistinguishedName(
                                            [
                                                AttributeTypeAndValue {
                                                    type: 2.5.4.6,
                                                    value: 13025553,
                                                },
                                            ],
                                        ),
                                    ],
                                ),
                            ),
                            validity: Validity {
                                not_before: UtcTime(
                                    UtcTime(
                                        2023-11-07T10:49:28Z,
                                    ),
                                ),
                                not_after: UtcTime(
                                    UtcTime(
                                        2037-07-16T10:49:28Z,
                                    ),
                                ),
                            },
                            subject: RdnSequence(
                                RdnSequence(
                                    [
                                        RelativeDistinguishedName(
                                            [
                                                AttributeTypeAndValue {
                                                    type: 0.9.2342.19200300.100.1.1,
                                                    value: 0c0474657374,
                                                },
                                            ],
                                        ),
                                        RelativeDistinguishedName(
                                            [
                                                AttributeTypeAndValue {
                                                    type: 2.5.4.3,
                                                    value: 0c2f4170706c6520446576656c6f706d656e743a20525341204170706c6520446576656c6f706d656e7420287465737429,
                                                },
                                            ],
                                        ),
                                        RelativeDistinguishedName(
                                            [
                                                AttributeTypeAndValue {
                                                    type: 2.5.4.11,
                                                    value: 0c0474657374,
                                                },
                                            ],
                                        ),
                                        RelativeDistinguishedName(
                                            [
                                                AttributeTypeAndValue {
                                                    type: 2.5.4.10,
                                                    value: 0c15525341204170706c6520446576656c6f706d656e74,
                                                },
                                            ],
                                        ),
                                        RelativeDistinguishedName(
                                            [
                                                AttributeTypeAndValue {
                                                    type: 2.5.4.6,
                                                    value: 13025553,
                                                },
                                            ],
                                        ),
                                    ],
                                ),
                            ),
                            subject_public_key_info: SubjectPublicKeyInfo {
                                algorithm: AlgorithmIdentifier {
                                    algorithm: 1.2.840.113549.1.1.1,
                                    parameters: Some(
                                        AlgorithmParameter(
                                            [ 05 00 ],
                                        ),
                                    ),
                                },
                                subject_public_key: 3082010a0282010100e6c9e2a15c321fbad0442e10bebb9824c6319fdaa7afd7c227bda4a81e152b9728855a375e34249f85f4127207a658bc091b447bb499f1f0884eecc98187630200f24c4d08e557624c33a4021ab5528581a92b902b4d436c3033cc27f67242f3eff171ed62f316fc0f138eb927e8d0568aecf11fc519487608509037e1382d81998c12f7b5913dd14bf9c26880bcc270c46b872023f83bdd1ba2395b34d6873ca5ff703dffbce5f561b55361a5a3bd01bfeda19f20b1a6bc89aadffb643d3e8faf2329609e11a587732f85405102de6a2cd76c2f95c95e22dd7af7ae9b8f238d2c60abad0595b3fa9c96b52e9ab95ef7af4596112de6fa5862aebc7aa24fe1fb0203010001 (unused 0),
                            },
                            issuer_unique_id: None,
                            subject_unique_id: None,
                            extensions: Some(
                                Extensions(
                                    [
                                        Extension {
                                            id: 2.5.29.19,
                                            critical: Some(
                                                true,
                                            ),
                                            value: 3000,
                                        },
                                        Extension {
                                            id: 2.5.29.37,
                                            critical: Some(
                                                true,
                                            ),
                                            value: 300a06082b06010505070303,
                                        },
                                        Extension {
                                            id: 2.5.29.15,
                                            critical: Some(
                                                true,
                                            ),
                                            value: 03020780,
                                        },
                                        Extension {
                                            id: 1.2.840.113635.100.6.1.2,
                                            critical: Some(
                                                true,
                                            ),
                                            value: 0500,
                                        },
                                        Extension {
                                            id: 1.2.840.113635.100.6.1.12,
                                            critical: Some(
                                                true,
                                            ),
                                            value: 0500,
                                        },
                                    ],
                                ),
                            ),
                            raw_data: Some("308202dfa003020102020101300d06092a864886f70d01010b050030818c31143012060a0992268993f22c6401010c04746573743138303606035504030c2f4170706c6520446576656c6f706d656e743a20525341204170706c6520446576656c6f706d656e7420287465737429310d300b060355040b0c0474657374311e301c060355040a0c15525341204170706c6520446576656c6f706d656e74310b3009060355040613025553301e170d3233313130373130343932385a170d3337303731363130343932385a30818c31143012060a0992268993f22c6401010c04746573743138303606035504030c2f4170706c6520446576656c6f706d656e743a20525341204170706c6520446576656c6f706d656e7420287465737429310d300b060355040b0c0474657374311e301c060355040a0c15525341204170706c6520446576656c6f706d656e74310b300906035504061302555330820122300d06092a864886f70d01010105000382010f003082010a0282010100e6c9e2a15c321fbad0442e10bebb9824c6319fdaa7afd7c227bda4a81e152b9728855a375e34249f85f4127207a658bc091b447bb499f1f0884eecc98187630200f24c4d08e557624c33a4021ab5528581a92b902b4d436c3033cc27f67242f3eff171ed62f316fc0f138eb927e8d0568aecf11fc519487608509037e1382d81998c12f7b5913dd14bf9c26880bcc270c46b872023f83bdd1ba2395b34d6873ca5ff703dffbce5f561b55361a5a3bd01bfeda19f20b1a6bc89aadffb643d3e8faf2329609e11a587732f85405102de6a2cd76c2f95c95e22dd7af7ae9b8f238d2c60abad0595b3fa9c96b52e9ab95ef7af4596112de6fa5862aebc7aa24fe1fb0203010001a3623060300c0603551d130101ff0402300030160603551d250101ff040c300a06082b06010505070303300e0603551d0f0101ff0404030207803013060a2a864886f763640601020101ff040205003013060a2a864886f7636406010c0101ff04020500"),
                        },
                        signature_algorithm: AlgorithmIdentifier {
                            algorithm: 1.2.840.113549.1.1.11,
                            parameters: Some(
                                AlgorithmParameter(
                                    [ 05 00 ],
                                ),
                            ),
                        },
                        signature: 99563303c646c61728b9758f16c559e6e1be2eae0884c8535834062b81f21c89a94c89c0ffb25b93b886535749d81e94440f6d257438e07cc701a7e69aa8bdeca71c3d2f686357f842c62a27b045c671b487d89fd3e69458aae19d69274e7b2d54f7f736e25196738185cab05ccd71b4d8a180610e1f771cfeee0198047692ec87fd3a4dbac1db4ff8205ddd7445d6184b11e3ca7018d6a495fa4b44bc1325fdd68050b45dddadf3a9a9ea0575a5b6d7a9d636f052f3b3d79729bf475efc9c95db4154f14d2ae598cb0debd424e0f0bfe59f11668f1e80e52412ae3f722bab026439addcf9a07b81cd17dec724afa51128e092038203c137f602cb154397c05a (unused 0),
                    },
                ),
            },
        ],
    ),
    signers: [
        SignerInfo {
            issuer: RdnSequence(
                RdnSequence(
                    [
                        RelativeDistinguishedName(
                            [
                                AttributeTypeAndValue {
                                    type: 0.9.2342.19200300.100.1.1,
                                    value: 0c0474657374,
                                },
                            ],
                        ),
                        RelativeDistinguishedName(
                            [
                                AttributeTypeAndValue {
                                    type: 2.5.4.3,
                                    value: 0c2f4170706c6520446576656c6f706d656e743a20525341204170706c6520446576656c6f706d656e7420287465737429,
                                },
                            ],
                        ),
                        RelativeDistinguishedName(
                            [
                                AttributeTypeAndValue {
                                    type: 2.5.4.11,
                                    value: 0c0474657374,
                                },
                            ],
                        ),
                        RelativeDistinguishedName(
                            [
                                AttributeTypeAndValue {
                                    type: 2.5.4.10,
                                    value: 0c15525341204170706c6520446576656c6f706d656e74,
                                },
                            ],
                        ),
                        RelativeDistinguishedName(
                            [
                                AttributeTypeAndValue {
                                    type: 2.5.4.6,
                                    value: 13025553,
                                },
                            ],
                        ),
                    ],
                ),
            ),
            serial_number: Integer(
                b"/x01",
            ),
            digest_algorithm: Sha256,
            signature_algorithm: RsaSha256,
            signature: 96d6e33faaa1450e597c130814ae89731a4982079cd657dcd55dd11db58ba68a5ad9c9d06f668b54c1219d8c689cc2ae05492c9bf374607e069cfde4d997058f992ea4760ccb70b6706757661f44d4e19f0f7c108bc530d3d39528ee4787c215e7b94d7b4afed4501da94471ba92b7a12867d2f45c282b49ec5f136308253d38e63eadc8fd4360794a4b4d9ab918b2694badafdad2d3e74aa17af059bff922dfdd8c3cd55a8063ca0f8c25a6b68e8c5d915008c471f7e3232e74a01d86c2a672ab0d5665cba6ab22433b62f9309bbcfd7dc9480eeb47f6085e39b2c64d10a971c75e714d73bb3e4219d2c3f5ccf896f38c7ffb1cb46bbfffd043f1e726cd015f,
            signed_attributes: Some(
                SignedAttributes {
                    content_type: 1.2.840.113549.1.7.1,
                    message_digest: 842501a2635a78877a86ef6545d12b4270bdf05f1a28b196a72686348e37a066,
                    signing_time: Some(
                        2023-11-05T10:00:00Z,
                    ),
                },
            ),
            digested_signed_attributes_data: Some("318201d4301806092a864886f70d010903310b06092a864886f70d010701301c06092a864886f70d010905310f170d3233313130353130303030305a302f06092a864886f70d01090431220420842501a2635a78877a86ef6545d12b4270bdf05f1a28b196a72686348e37a066303c06092a864886f763640902312f302d06096086480165030402010420842501a2635a78877a86ef6545d12b4270bdf05f1a28b196a72686348e37a0663082012906092a864886f7636409013182011a048201163c3f786d6c2076657273696f6e3d22312e302220656e636f64696e673d225554462d38223f3e0a3c21444f435459504520706c697374205055424c494320222d2f2f4170706c652f2f44544420504c49535420312e302f2f454e222022687474703a2f2f7777772e6170706c652e636f6d2f445444732f50726f70657274794c6973742d312e302e647464223e0a3c706c6973742076657273696f6e3d22312e30223e0a3c646963743e0a093c6b65793e63646861736865733c2f6b65793e0a093c61727261793e0a09093c646174613e0a0909684355426f6d4e61654964366875396c52644572516e43393846383d0a09093c2f646174613e0a093c2f61727261793e0a3c2f646963743e0a3c2f706c6973743e0a"),
            unsigned_attributes: None,
        },
    ],
}

$ rcodesign print-signature-info exe.signed
- path: exe.signed
  file_size: 22544
  file_sha256: 21b6d565e132590158cdb5e4ee25d938a03c3b967d1985c4ff2bef46725b194a
  entity:
    mach_o:
      linkedit_segment_file_start_offset: 16384
      linkedit_segment_file_end_offset: 22544
      signature_file_start_offset: 16400
      signature_file_end_offset: 22544
      signature_linkedit_start_offset: 16
      signature_linkedit_end_offset: 6160
      signature:
        superblob_length: 2446
        blob_count: 3
        blobs:
        - slot: CodeDirectory (0)
          magic: fade0c02
          length: 321
          sha1: 27ee9bba25ab1744a2127907053d482591fd6efe
          sha256: 842501a2635a78877a86ef6545d12b4270bdf05f1a28b196a72686348e37a066
        - slot: RequirementSet (2)
          magic: fade0c01
          length: 80
          sha1: 4f9d3e687a7622d7209180eeca44e6a4c97a2187
          sha256: f48f861e449222d508463e8342afee0c2241817878cab57b21e38e6aea0c08fa
        - slot: CMS Signature (65536)
          magic: fade0b01
          length: 2009
          sha1: bf3cf250f4be3406b856d8cf1f7d8636427b3f43
          sha256: 507fb7575c75812e939975242897f46742fe981dce1ae7ab669e3a0d51fcb7af
        code_directory:
          version: '0x20400'
          flags: CodeSignatureFlags(0x0)
          identifier: exe
          team_name: test
          digest_type: sha256
          platform: 0
          signed_entity_size: 16400
          executable_segment_flags: ExecutableSegmentFlags(MAIN_BINARY)
          code_digests_count: 5
          slot_digests:
          - 'Info (1): 0000000000000000000000000000000000000000000000000000000000000000'
          - 'RequirementSet (2): f48f861e449222d508463e8342afee0c2241817878cab57b21e38e6aea0c08fa'
        code_requirements:
        - 'designated(3): 0: (identifier "exe") and (anchor -1 H"e1c7216e46533c923b7cfc94e86c7043790b96e9");'
        cms:
          certificates:
          - subject: 'CN=Apple Development: RSA Apple Development (test), OU=test, O=RSA Apple Development, C=US'
            issuer: 'CN=Apple Development: RSA Apple Development (test), OU=test, O=RSA Apple Development, C=US'
            key_algorithm: RSA
            signature_algorithm: SHA-256 with RSA encryption
            signed_with_algorithm: SHA-256 with RSA encryption
            is_apple_root_ca: false
            is_apple_intermediate_ca: false
            chains_to_apple_root_ca: false
            apple_extended_key_usages:
            - Code Signing
            apple_code_signing_extensions:
            - iPhone Developer
            - Mac Developer
            apple_certificate_profile: apple-development
            apple_team_id: test
          signers:
          - issuer: 'CN=Apple Development: RSA Apple Development (test), OU=test, O=RSA Apple Development, C=US'
            digest_algorithm: SHA-256
            signature_algorithm: SHA-256 with RSA encryption
            attributes:
            - 1.2.840.113549.1.9.3
            - 1.2.840.113549.1.9.4
            - 1.2.840.113549.1.9.5
            - 1.2.840.113635.100.9.1
            - 1.2.840.113635.100.9.2
            content_type: 1.2.840.113549.1.7.1
            message_digest: 842501a2635a78877a86ef6545d12b4270bdf05f1a28b196a72686348e37a066
            signing_time: 2023-11-05T10:00:00Z
            cdhash_plist:
            - <?xml version="1.0" encoding="UTF-8"?>
            - <plist version="1.0">
            - '  <dict>'
            - '    <key>cdhashes</key>'
            - '    <array>'
            - '      <data>'
            - "/t/thCUBomNaeId6hu9lRdErQnC98F8="
            - "/t/t</data>"
            - '    </array>'
            - '  </dict>'
            - </plist>
            cdhash_digests:
            - - 2.16.840.1.101.3.4.2.1
              - 842501a2635a78877a86ef6545d12b4270bdf05f1a28b196a72686348e37a066
            signature_verifies: true

```